{"ast":null,"code":"import _classCallCheck from\"C:\\\\Prayuj Folders\\\\Game-Renting-Service\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Prayuj Folders\\\\Game-Renting-Service\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"C:\\\\Prayuj Folders\\\\Game-Renting-Service\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:\\\\Prayuj Folders\\\\Game-Renting-Service\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Prayuj Folders\\\\Game-Renting-Service\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import axios from\"axios\";import Modal from\"react-bootstrap/Modal\";import Button from\"react-bootstrap/Button\";import{Redirect}from\"react-router-dom\";import LoadingSpinner from\"./loadingSpinner\";import Toast from\"react-bootstrap/Toast\";var CustomerPage=/*#__PURE__*/function(_Component){_inherits(CustomerPage,_Component);var _super=_createSuper(CustomerPage);function CustomerPage(props){var _this;_classCallCheck(this,CustomerPage);_this=_super.call(this,props);_this.setRedirect=function(e){console.log(e.target.attributes[1].value);if(e.target.attributes[0].value===\"transaction\"){_this.setState({redirect_to_transaction:true,transaction_id:e.target.attributes[1].value});}else if(e.target.value===\"Update\"){_this.setState({otp_issued:false,verifying:false});axios.get(\"https://prayuj-gamerent.herokuapp.com/customer/generate_otp/id=\"+_this.state.id+\"&mode=Updating&game=Null&console=Null\").then(function(res){console.log(res.data);_this.setState({message:res.data.message,otp_issued:true});});_this.setState({modal_show:true});}else if(e.target.value===\"Issue\")_this.setState({redirect_to_issue:true});else if(e.target.value===\"Return\")_this.setState({redirect_to_return:true});else if(e.target.value===\"Add Plan\")_this.setState({redirect_to_add_plan:true});};_this.renderRedirect=function(){if(_this.state.redirect_to_update){return/*#__PURE__*/React.createElement(Redirect,{push:true,to:\"/update_customer/\"+_this.state.id});}if(_this.state.redirect_to_add_plan){return/*#__PURE__*/React.createElement(Redirect,{push:true,to:\"/add_plan/\"+_this.state.id});}if(_this.state.redirect_to_issue){return/*#__PURE__*/React.createElement(Redirect,{push:true,to:\"/issue/mode=customer&id=\"+_this.state.id});}if(_this.state.redirect_to_return){return/*#__PURE__*/React.createElement(Redirect,{push:true,to:\"/return/mode=customer&id=\"+_this.state.id});}if(_this.state.redirect_to_transaction){return/*#__PURE__*/React.createElement(Redirect,{push:true,to:\"/transaction/\"+_this.state.transaction_id});}};_this.state={id:props.match.params.id,data:\"\",history:[],modal_show:false,history_loaded:false,data_loaded:false,otp_issued:false,verifying:false};_this.handleClick=_this.handleClick.bind(_assertThisInitialized(_this));return _this;}_createClass(CustomerPage,[{key:\"componentDidMount\",value:function componentDidMount(){this.getCustomerDetail();this.getCustomerGameHistory();}},{key:\"getCustomerGameHistory\",value:function getCustomerGameHistory(){var _this2=this;axios.get(\"https://prayuj-gamerent.herokuapp.com/customer/history/\"+this.state.id).then(function(res){console.log(res.data);if(res.data)_this2.setState({history:res.data,history_loaded:true});else _this2.setState({history:[],history_loaded:true});}).catch(function(err){return console.log(err);});}},{key:\"getCustomerDetail\",value:function getCustomerDetail(){var _this3=this;axios.get(\"https://prayuj-gamerent.herokuapp.com/customer/\"+this.state.id).then(function(res){_this3.setState({data:res.data,data_loaded:true});}).catch(function(err){return console.log(err);});}},{key:\"handleClick\",value:function handleClick(e){var _this4=this;e.preventDefault();console.log(e.target.otp.value);var customer_id=this.state.id;this.setState({verifying:true});axios.post(\"https://prayuj-gamerent.herokuapp.com/customer/verify_otp/\"+customer_id,{otp:e.target.otp.value}).then(function(res){console.log(res.data.isVerify);if(res.data.isVerify){_this4.setState({redirect_to_update:true});}else{_this4.setState({verifying:false});alert(\"Incorrect OTP, Issue again\");}});}},{key:\"convertDate\",value:function convertDate(dates){var date=new Date(dates);var dd=String(date.getDate()).padStart(2,\"0\");var mm=String(date.getMonth()+1).padStart(2,\"0\");//January is 0!\nvar yyyy=date.getFullYear();var today=dd+\"/\"+mm+\"/\"+yyyy;return today;}},{key:\"render\",value:function render(){var _this5=this;console.log(this.state.data);var membership=this.state.data.membership?this.state.data.membership.map(function(member,index){return/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,index+1),/*#__PURE__*/React.createElement(\"td\",null,member.plan),/*#__PURE__*/React.createElement(\"td\",null,_this5.convertDate(member.start)),/*#__PURE__*/React.createElement(\"td\",null,_this5.convertDate(member.end)),/*#__PURE__*/React.createElement(\"td\",null,member.active?\"True\":\"False\"));}):/*#__PURE__*/React.createElement(\"div\",null);var history=this.state.history.length>0?this.state.history.map(function(game,index){return/*#__PURE__*/React.createElement(\"tr\",{className:\"items\",onClick:_this5.setRedirect,value:\"transaction\",id:game._id},/*#__PURE__*/React.createElement(\"td\",{value:\"transaction\",id:game._id},index+1),/*#__PURE__*/React.createElement(\"td\",{value:\"transaction\",id:game._id},game.gameInfo.name),/*#__PURE__*/React.createElement(\"td\",{value:\"transaction\",id:game._id},game.gameInfo.items.console),/*#__PURE__*/React.createElement(\"td\",{value:\"transaction\",id:game._id},game.gameInfo.items.serial_no),/*#__PURE__*/React.createElement(\"td\",{value:\"transaction\",id:game._id},_this5.convertDate(game.date_issue)),/*#__PURE__*/React.createElement(\"td\",{value:\"transaction\",id:game._id},game.return?_this5.convertDate(game.date_return):\"Not Returned\"));}):/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{colSpan:\"6\",style:{position:\"relative\",top:\"50%\",left:\"50%\"}},\"No Past History\"));return/*#__PURE__*/React.createElement(\"div\",null,this.renderRedirect(),/*#__PURE__*/React.createElement(\"input\",{type:\"button\",onClick:this.setRedirect,className:\"btn btn-primary\",value:\"Update\"}),/*#__PURE__*/React.createElement(\"input\",{type:\"button\",onClick:this.setRedirect,className:\"btn btn-primary\",value:\"Add Plan\"}),/*#__PURE__*/React.createElement(\"input\",{type:\"button\",onClick:this.setRedirect,className:\"btn btn-primary\",value:\"Issue\"}),/*#__PURE__*/React.createElement(\"input\",{type:\"button\",onClick:this.setRedirect,className:\"btn btn-primary\",value:\"Return\"}),this.state.data_loaded?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"strong\",null,\"Name: \"),\" \",this.state.data.name),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"strong\",null,\"Email: \"),this.state.data.email),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"strong\",null,\"Addr: \"),this.state.data.address),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"strong\",null,\"Addr2: \"),this.state.data.address2),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"strong\",null,\"ZIP: \"),this.state.data.zip),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"strong\",null,\"Mobile Number: \"),this.state.data.mobile_no),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"strong\",null,\"Alt Mobile No: \"),this.state.data.alt_mobile_no),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"strong\",null,\"Date Of Join: \"),this.convertDate(this.state.data.dateOfJoin))):/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(LoadingSpinner,null)),/*#__PURE__*/React.createElement(\"div\",{className:\"table-responsive-xl\"},/*#__PURE__*/React.createElement(\"table\",{className:\"table\",style:{marginTop:20}},/*#__PURE__*/React.createElement(\"thead\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"th\",null,\"Sr\"),/*#__PURE__*/React.createElement(\"th\",null,\"Plan Name\"),/*#__PURE__*/React.createElement(\"th\",null,\"Start\"),/*#__PURE__*/React.createElement(\"th\",null,\"End\"),/*#__PURE__*/React.createElement(\"th\",null,\"Active\"))),/*#__PURE__*/React.createElement(\"tbody\",null,this.state.data_loaded?membership:/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{colSpan:\"5\",style:{position:\"relative\",top:\"50%\",left:\"50%\"}},/*#__PURE__*/React.createElement(LoadingSpinner,null)))))),/*#__PURE__*/React.createElement(\"h3\",null,\"Past History:\"),/*#__PURE__*/React.createElement(\"div\",{className:\"table-responsive-xl\"},/*#__PURE__*/React.createElement(\"table\",{className:\"table\",style:{marginTop:20}},/*#__PURE__*/React.createElement(\"thead\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"th\",null,\"Sr\"),/*#__PURE__*/React.createElement(\"th\",null,\"Game\"),/*#__PURE__*/React.createElement(\"th\",null,\"Console\"),/*#__PURE__*/React.createElement(\"th\",null,\"Serial no\"),/*#__PURE__*/React.createElement(\"th\",null,\"Date Issue\"),/*#__PURE__*/React.createElement(\"th\",null,\"Date Return\"))),/*#__PURE__*/React.createElement(\"tbody\",null,this.state.history_loaded?history:/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{colSpan:\"6\",style:{position:\"relative\",top:\"50%\",left:\"50%\"}},/*#__PURE__*/React.createElement(LoadingSpinner,null)))))),/*#__PURE__*/React.createElement(Modal,{show:this.state.modal_show},/*#__PURE__*/React.createElement(Modal.Header,null,/*#__PURE__*/React.createElement(Modal.Title,null,\"Game Return\")),/*#__PURE__*/React.createElement(\"form\",{onSubmit:this.handleClick},/*#__PURE__*/React.createElement(Modal.Body,null,/*#__PURE__*/React.createElement(\"div\",null,\"Enter OTP\",/*#__PURE__*/React.createElement(\"input\",{type:\"number\",name:\"otp\"})),this.state.otp_issued?/*#__PURE__*/React.createElement(Toast,null,/*#__PURE__*/React.createElement(Toast.Header,null,/*#__PURE__*/React.createElement(\"strong\",{className:\"mr-auto\"},\"OTP\")),/*#__PURE__*/React.createElement(Toast.Body,null,this.state.message)):/*#__PURE__*/React.createElement(LoadingSpinner,null)),/*#__PURE__*/React.createElement(Modal.Footer,null,/*#__PURE__*/React.createElement(Button,{variant:\"secondary\",onClick:function onClick(){return _this5.setState({modal_show:false});}},\"Close\"),/*#__PURE__*/React.createElement(Button,{variant:\"primary\",type:\"submit\"},this.state.verifying?/*#__PURE__*/React.createElement(LoadingSpinner,null):\"Verify\")))));}}]);return CustomerPage;}(Component);export default CustomerPage;","map":{"version":3,"sources":["C:/Prayuj Folders/Game-Renting-Service/frontend/src/components/customerPage.js"],"names":["React","Component","axios","Modal","Button","Redirect","LoadingSpinner","Toast","CustomerPage","props","setRedirect","e","console","log","target","attributes","value","setState","redirect_to_transaction","transaction_id","otp_issued","verifying","get","state","id","then","res","data","message","modal_show","redirect_to_issue","redirect_to_return","redirect_to_add_plan","renderRedirect","redirect_to_update","match","params","history","history_loaded","data_loaded","handleClick","bind","getCustomerDetail","getCustomerGameHistory","catch","err","preventDefault","otp","customer_id","post","isVerify","alert","dates","date","Date","dd","String","getDate","padStart","mm","getMonth","yyyy","getFullYear","today","membership","map","member","index","plan","convertDate","start","end","active","length","game","_id","gameInfo","name","items","serial_no","date_issue","return","date_return","position","top","left","email","address","address2","zip","mobile_no","alt_mobile_no","dateOfJoin","marginTop"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport axios from \"axios\";\r\nimport Modal from \"react-bootstrap/Modal\";\r\nimport Button from \"react-bootstrap/Button\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport LoadingSpinner from \"./loadingSpinner\";\r\nimport Toast from \"react-bootstrap/Toast\";\r\n\r\nclass CustomerPage extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      id: props.match.params.id,\r\n      data: \"\",\r\n      history: [],\r\n      modal_show: false,\r\n      history_loaded: false,\r\n      data_loaded: false,\r\n      otp_issued: false,\r\n      verifying: false,\r\n    };\r\n    this.handleClick = this.handleClick.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getCustomerDetail();\r\n    this.getCustomerGameHistory();\r\n  }\r\n  getCustomerGameHistory() {\r\n    axios\r\n      .get(\r\n        \"https://prayuj-gamerent.herokuapp.com/customer/history/\" +\r\n          this.state.id\r\n      )\r\n      .then((res) => {\r\n        console.log(res.data);\r\n        if (res.data)\r\n          this.setState({\r\n            history: res.data,\r\n            history_loaded: true,\r\n          });\r\n        else\r\n          this.setState({\r\n            history: [],\r\n            history_loaded: true,\r\n          });\r\n      })\r\n      .catch((err) => console.log(err));\r\n  }\r\n  getCustomerDetail() {\r\n    axios\r\n      .get(\"https://prayuj-gamerent.herokuapp.com/customer/\" + this.state.id)\r\n      .then((res) => {\r\n        this.setState({\r\n          data: res.data,\r\n          data_loaded: true,\r\n        });\r\n      })\r\n      .catch((err) => console.log(err));\r\n  }\r\n\r\n  setRedirect = (e) => {\r\n    console.log(e.target.attributes[1].value);\r\n    if (e.target.attributes[0].value === \"transaction\") {\r\n      this.setState({\r\n        redirect_to_transaction: true,\r\n        transaction_id: e.target.attributes[1].value,\r\n      });\r\n    } else if (e.target.value === \"Update\") {\r\n      this.setState({\r\n        otp_issued: false,\r\n        verifying: false,\r\n      });\r\n      axios\r\n        .get(\r\n          \"https://prayuj-gamerent.herokuapp.com/customer/generate_otp/id=\" +\r\n            this.state.id +\r\n            \"&mode=Updating&game=Null&console=Null\"\r\n        )\r\n        .then((res) => {\r\n          console.log(res.data);\r\n          this.setState({ message: res.data.message, otp_issued: true });\r\n        });\r\n      this.setState({\r\n        modal_show: true,\r\n      });\r\n    } else if (e.target.value === \"Issue\")\r\n      this.setState({\r\n        redirect_to_issue: true,\r\n      });\r\n    else if (e.target.value === \"Return\")\r\n      this.setState({\r\n        redirect_to_return: true,\r\n      });\r\n    else if (e.target.value === \"Add Plan\")\r\n      this.setState({\r\n        redirect_to_add_plan: true,\r\n      });\r\n  };\r\n\r\n  renderRedirect = () => {\r\n    if (this.state.redirect_to_update) {\r\n      return <Redirect push to={\"/update_customer/\" + this.state.id} />;\r\n    }\r\n    if (this.state.redirect_to_add_plan) {\r\n      return <Redirect push to={\"/add_plan/\" + this.state.id} />;\r\n    }\r\n    if (this.state.redirect_to_issue) {\r\n      return <Redirect push to={\"/issue/mode=customer&id=\" + this.state.id} />;\r\n    }\r\n    if (this.state.redirect_to_return) {\r\n      return <Redirect push to={\"/return/mode=customer&id=\" + this.state.id} />;\r\n    }\r\n    if (this.state.redirect_to_transaction) {\r\n      return <Redirect push to={\"/transaction/\" + this.state.transaction_id} />;\r\n    }\r\n  };\r\n\r\n  handleClick(e) {\r\n    e.preventDefault();\r\n    console.log(e.target.otp.value);\r\n    let customer_id = this.state.id;\r\n    this.setState({\r\n      verifying: true,\r\n    });\r\n    axios\r\n      .post(\r\n        \"https://prayuj-gamerent.herokuapp.com/customer/verify_otp/\" +\r\n          customer_id,\r\n        {\r\n          otp: e.target.otp.value,\r\n        }\r\n      )\r\n      .then((res) => {\r\n        console.log(res.data.isVerify);\r\n        if (res.data.isVerify) {\r\n          this.setState({\r\n            redirect_to_update: true,\r\n          });\r\n        } else {\r\n          this.setState({ verifying: false });\r\n          alert(\"Incorrect OTP, Issue again\");\r\n        }\r\n      });\r\n  }\r\n\r\n  convertDate(dates) {\r\n    var date = new Date(dates);\r\n    var dd = String(date.getDate()).padStart(2, \"0\");\r\n    var mm = String(date.getMonth() + 1).padStart(2, \"0\"); //January is 0!\r\n    var yyyy = date.getFullYear();\r\n    var today = dd + \"/\" + mm + \"/\" + yyyy;\r\n    return today;\r\n  }\r\n  render() {\r\n    console.log(this.state.data);\r\n    let membership = this.state.data.membership ? (\r\n      this.state.data.membership.map((member, index) => (\r\n        <tr>\r\n          <td>{index + 1}</td>\r\n          <td>{member.plan}</td>\r\n          <td>{this.convertDate(member.start)}</td>\r\n          <td>{this.convertDate(member.end)}</td>\r\n          <td>{member.active ? \"True\" : \"False\"}</td>\r\n        </tr>\r\n      ))\r\n    ) : (\r\n      <div />\r\n    );\r\n\r\n    let history =\r\n      this.state.history.length > 0 ? (\r\n        this.state.history.map((game, index) => (\r\n          <tr\r\n            className=\"items\"\r\n            onClick={this.setRedirect}\r\n            value=\"transaction\"\r\n            id={game._id}\r\n          >\r\n            <td value=\"transaction\" id={game._id}>\r\n              {index + 1}\r\n            </td>\r\n            <td value=\"transaction\" id={game._id}>\r\n              {game.gameInfo.name}\r\n            </td>\r\n            <td value=\"transaction\" id={game._id}>\r\n              {game.gameInfo.items.console}\r\n            </td>\r\n            <td value=\"transaction\" id={game._id}>\r\n              {game.gameInfo.items.serial_no}\r\n            </td>\r\n            <td value=\"transaction\" id={game._id}>\r\n              {this.convertDate(game.date_issue)}\r\n            </td>\r\n            <td value=\"transaction\" id={game._id}>\r\n              {game.return\r\n                ? this.convertDate(game.date_return)\r\n                : \"Not Returned\"}\r\n            </td>\r\n          </tr>\r\n        ))\r\n      ) : (\r\n        <tr>\r\n          <td\r\n            colSpan=\"6\"\r\n            style={{ position: \"relative\", top: \"50%\", left: \"50%\" }}\r\n          >\r\n            No Past History\r\n          </td>\r\n        </tr>\r\n      );\r\n\r\n    return (\r\n      <div>\r\n        {this.renderRedirect()}\r\n        <input\r\n          type=\"button\"\r\n          onClick={this.setRedirect}\r\n          className=\"btn btn-primary\"\r\n          value=\"Update\"\r\n        />\r\n        <input\r\n          type=\"button\"\r\n          onClick={this.setRedirect}\r\n          className=\"btn btn-primary\"\r\n          value=\"Add Plan\"\r\n        />\r\n        <input\r\n          type=\"button\"\r\n          onClick={this.setRedirect}\r\n          className=\"btn btn-primary\"\r\n          value=\"Issue\"\r\n        />\r\n        <input\r\n          type=\"button\"\r\n          onClick={this.setRedirect}\r\n          className=\"btn btn-primary\"\r\n          value=\"Return\"\r\n        />\r\n        {this.state.data_loaded ? (\r\n          <>\r\n            <div>\r\n              <strong>Name: </strong> {this.state.data.name}\r\n            </div>\r\n            <div>\r\n              <strong>Email: </strong>\r\n              {this.state.data.email}\r\n            </div>\r\n            <div>\r\n              <strong>Addr: </strong>\r\n              {this.state.data.address}\r\n            </div>\r\n            <div>\r\n              <strong>Addr2: </strong>\r\n              {this.state.data.address2}\r\n            </div>\r\n            <div>\r\n              <strong>ZIP: </strong>\r\n              {this.state.data.zip}\r\n            </div>\r\n            <div>\r\n              <strong>Mobile Number: </strong>\r\n              {this.state.data.mobile_no}\r\n            </div>\r\n            <div>\r\n              <strong>Alt Mobile No: </strong>\r\n              {this.state.data.alt_mobile_no}\r\n            </div>\r\n            <div>\r\n              <strong>Date Of Join: </strong>\r\n              {this.convertDate(this.state.data.dateOfJoin)}\r\n            </div>\r\n          </>\r\n        ) : (\r\n          <div>\r\n            <LoadingSpinner></LoadingSpinner>\r\n          </div>\r\n        )}\r\n        <div className=\"table-responsive-xl\">\r\n          <table className=\"table\" style={{ marginTop: 20 }}>\r\n            <thead>\r\n              <tr>\r\n                <th>Sr</th>\r\n                <th>Plan Name</th>\r\n                <th>Start</th>\r\n                <th>End</th>\r\n                <th>Active</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {this.state.data_loaded ? (\r\n                membership\r\n              ) : (\r\n                <tr>\r\n                  <td\r\n                    colSpan=\"5\"\r\n                    style={{ position: \"relative\", top: \"50%\", left: \"50%\" }}\r\n                  >\r\n                    <LoadingSpinner></LoadingSpinner>\r\n                  </td>\r\n                </tr>\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n        <h3>Past History:</h3>\r\n        <div className=\"table-responsive-xl\">\r\n          <table className=\"table\" style={{ marginTop: 20 }}>\r\n            <thead>\r\n              <tr>\r\n                <th>Sr</th>\r\n                <th>Game</th>\r\n                <th>Console</th>\r\n                <th>Serial no</th>\r\n                <th>Date Issue</th>\r\n                <th>Date Return</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {this.state.history_loaded ? (\r\n                history\r\n              ) : (\r\n                <tr>\r\n                  <td\r\n                    colSpan=\"6\"\r\n                    style={{ position: \"relative\", top: \"50%\", left: \"50%\" }}\r\n                  >\r\n                    <LoadingSpinner></LoadingSpinner>\r\n                  </td>\r\n                </tr>\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n        <Modal show={this.state.modal_show}>\r\n          <Modal.Header>\r\n            <Modal.Title>Game Return</Modal.Title>\r\n          </Modal.Header>\r\n          <form onSubmit={this.handleClick}>\r\n            <Modal.Body>\r\n              <div>\r\n                Enter OTP\r\n                <input type=\"number\" name=\"otp\" />\r\n              </div>\r\n              {this.state.otp_issued ? (\r\n                <Toast>\r\n                  <Toast.Header>\r\n                    <strong className=\"mr-auto\">OTP</strong>\r\n                  </Toast.Header>\r\n                  <Toast.Body>{this.state.message}</Toast.Body>\r\n                </Toast>\r\n              ) : (\r\n                <LoadingSpinner></LoadingSpinner>\r\n              )}\r\n            </Modal.Body>\r\n\r\n            <Modal.Footer>\r\n              <Button\r\n                variant=\"secondary\"\r\n                onClick={() => this.setState({ modal_show: false })}\r\n              >\r\n                Close\r\n              </Button>\r\n              <Button variant=\"primary\" type=\"submit\">\r\n                {this.state.verifying ? (\r\n                  <LoadingSpinner></LoadingSpinner>\r\n                ) : (\r\n                  \"Verify\"\r\n                )}\r\n              </Button>\r\n            </Modal.Footer>\r\n          </form>\r\n        </Modal>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default CustomerPage;\r\n"]},"metadata":{},"sourceType":"module"}