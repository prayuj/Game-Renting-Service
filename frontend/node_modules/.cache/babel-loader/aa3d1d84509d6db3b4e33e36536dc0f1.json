{"ast":null,"code":"import _classCallCheck from\"C:\\\\Prayuj Folders\\\\Game-Renting-Service\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Prayuj Folders\\\\Game-Renting-Service\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"C:\\\\Prayuj Folders\\\\Game-Renting-Service\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:\\\\Prayuj Folders\\\\Game-Renting-Service\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Prayuj Folders\\\\Game-Renting-Service\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import axios from\"axios\";import{Redirect}from\"react-router-dom\";import Modal from\"react-bootstrap/Modal\";import Button from\"react-bootstrap/Button\";import Toast from\"react-bootstrap/Toast\";import LoadingSpinner from\"./loadingSpinner\";var Issue=/*#__PURE__*/function(_Component){_inherits(Issue,_Component);var _super=_createSuper(Issue);function Issue(props){var _this;_classCallCheck(this,Issue);_this=_super.call(this,props);_this.setRedirect=function(){_this.setState({redirect_to_transaction:true});};_this.renderRedirect=function(){if(_this.state.redirect_to_transaction){return/*#__PURE__*/React.createElement(Redirect,{push:true,to:\"/transaction/\"+_this.state.transactionid});}};if(props.match.params.mode===\"customer\")_this.state={mode:\"customer\",customer_id:props.match.params.id,show:false,games:[],console:[],redirect_to_transaction:false,modal_show:false,button_disable:true,otp_issued:false,verifying:false};else if(props.match.params.mode===\"game\")_this.state={mode:\"game\",game_id:props.match.params.id,show:false,customers:[],console:[],redirect_to_transaction:false,modal_show:false,button_disable:true,otp_issued:false,verifying:false};else if(props.match.params.mode===\"dashboard\")_this.state={mode:\"dashboard\",customers:[],show:true,games:[],console:[],redirect_to_transaction:false,modal_show:false,button_disable:true,otp_issued:false,verifying:false};_this.handleForm=_this.handleForm.bind(_assertThisInitialized(_this));_this.handleGameChange=_this.handleGameChange.bind(_assertThisInitialized(_this));_this.confirmIssue=_this.confirmIssue.bind(_assertThisInitialized(_this));_this.modalClose=_this.modalClose.bind(_assertThisInitialized(_this));return _this;}_createClass(Issue,[{key:\"componentDidMount\",value:function componentDidMount(){this.getCustomerDetail();this.getGames();}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){var _this2=this;console.log(this.state.mode,this.props.match.params.mode);if(this.state.mode!==this.props.match.params.mode){if(this.props.match.params.mode===\"customer\")this.setState({mode:\"customer\",customer_id:this.props.match.params.id},function(){_this2.getCustomerDetail();_this2.getGames();});else if(this.props.match.params.mode===\"game\")this.setState({mode:\"game\",game_id:this.props.match.params.id},function(){_this2.getCustomerDetail();_this2.getGames();});else if(this.props.match.params.mode===\"dashboard\")this.setState({mode:\"dashboard\",show:true},function(){_this2.getCustomerDetail();_this2.getGames();});}}},{key:\"getCustomerDetail\",value:function getCustomerDetail(){var _this3=this;if(this.state.mode===\"customer\"){axios.get(\"https://prayuj-gamerent.herokuapp.com/customer/issue/\"+this.state.customer_id).then(function(res){console.log(res.data);_this3.setState({customers:[res.data]});if(res.data.length==0){console.log(\"No Active Membership\");_this3.setState({show:false});}else if(res.data.plan===\"1Y4G\"&&res.data.noOfGames<4){console.log(\"4 game plan\");_this3.setState({show:true});}else if(res.data.plan===\"6M2G\"&&res.data.noOfGames<2){console.log(\"2 game plan\");_this3.setState({show:true});}else if(res.data.plan===\"3M1G\"&&res.data.noOfGames<1){console.log(\"1 game plan\");_this3.setState({show:true});}else{console.log(\"5th condition\");_this3.setState({show:false});}_this3.setState({data:res.data[0]});}).catch(function(err){return console.log(err);});}else{axios.get(\"https://prayuj-gamerent.herokuapp.com/customer\").then(function(res){var customers_to_display=[];for(var i=0;i<res.data.length;i++){if(res.data[i].latestMembership.active){if(res.data[i].latestMembership.plan===\"1Y4G\"&&res.data[i].noOfGames<4){console.log(\"4 game plan\");customers_to_display.push(res.data[i]);}else if(res.data[i].latestMembership.plan===\"6M2G\"&&res.data[i].noOfGames<2){console.log(\"2 game plan\");customers_to_display.push(res.data[i]);}else if(res.data[i].latestMembership.plan===\"3M1G\"&&res.data[i].noOfGames<1){console.log(\"1 game plan\");customers_to_display.push(res.data[i]);}else{console.log(\"5th condition\");}}}_this3.setState({customers:customers_to_display});}).catch(function(err){return console.log(err);});}}},{key:\"getGames\",value:function getGames(){var _this4=this;if(this.state.mode===\"game\")axios.get(\"https://prayuj-gamerent.herokuapp.com/game/\"+this.state.game_id).then(function(res){console.log(res.data);_this4.setState({games:[res.data]});if(res.data.numberAvailable>0){_this4.setState({show:true});}if(res.data.numberPS4Available>0&&res.data.numberXBOXAvailable>0){_this4.setState({console:[\"PS4\",\"XBOX One\"]});}else if(res.data.numberPS4Available>0){_this4.setState({console:[\"PS4\"]});}else if(res.data.numberXBOXAvailable>0){_this4.setState({console:[\"XBOX One\"]});}else{_this4.setState({console:[]});}});else axios.get(\"https://prayuj-gamerent.herokuapp.com/game\").then(function(res){console.log(res.data);_this4.setState({games:res.data});});}},{key:\"modalClose\",value:function modalClose(){{this.setState({modal_show:false});}}},{key:\"confirmIssue\",value:function confirmIssue(e){var _this5=this;e.preventDefault();console.log(e.target.game.value,e.target.console.value,e.target.customer.value);this.setState({otp_issued:false,verifying:false});if(e.target.game.value!=\"default\"&&e.target.console.value!=\"default\"&&e.target.customer.value!=\"default\"){this.setState({modal_show:true,game_id:e.target.game.value,selected_console:e.target.console.value,customer_id:e.target.customer.value,button_disable:false});console.log(\"https://prayuj-gamerent.herokuapp.com/customer/generate_otp/id=\"+e.target.customer.value+\"&mode=Issuing\"+\"&game=\"+e.target.game.value+\"&console=\"+e.target.console.value);axios.get(\"https://prayuj-gamerent.herokuapp.com/customer/generate_otp/id=\"+e.target.customer.value+\"&mode=Issuing\"+\"&game=\"+e.target.game.value+\"&console=\"+e.target.console.value).then(function(res){console.log(res.data);_this5.setState({message:res.data.message,otp_issued:true});});}else this.setState({modal_show:true});}},{key:\"handleForm\",value:function handleForm(e){var _this6=this;e.preventDefault();console.log(e.target.otp.value);var customer_id=this.state.customer_id;var game_id=this.state.game_id;var game_console=this.state.selected_console;var data={game_id:game_id,console:game_console};this.setState({verifying:true});console.log(JSON.stringify(data));axios.post(\"https://prayuj-gamerent.herokuapp.com/customer/verify_otp/\"+customer_id,{otp:e.target.otp.value}).then(function(res){console.log(res.data.isVerify);if(res.data.isVerify){axios.post(\"https://prayuj-gamerent.herokuapp.com/customer/issue/\"+customer_id,data).then(function(res){if(res.data.game!=\"Not Available\"){_this6.setState({show:true});_this6.setState({transactionid:res.data.game});_this6.setRedirect();}else{alert(res.data.game);}}).catch(function(err){alert(JSON.stringify(err));});}else{alert(\"Incorrect OTP, Issue again\");}});}},{key:\"handleGameChange\",value:function handleGameChange(e){console.log(e.target.value);var games=this.state.games;for(var i=0;i<games.length;i++){if(games[i]._id===e.target.value){if(games[i].numberPS4Available>0&&games[i].numberXBOXAvailable>0){this.setState({console:[\"PS4\",\"XBOX One\"]});}else if(games[i].numberPS4Available>0){this.setState({console:[\"PS4\"]});}else if(games[i].numberXBOXAvailable>0){this.setState({console:[\"XBOX One\"]});}else{this.setState({console:[]});}}}}},{key:\"render\",value:function render(){if(this.state.show){var customers;var games;var _console=this.state.console.length==0?/*#__PURE__*/React.createElement(\"select\",{className:\"form-control\",name:\"console\",disabled:true},/*#__PURE__*/React.createElement(\"option\",{value:\"default\"},\"Not Available\")):/*#__PURE__*/React.createElement(\"select\",{className:\"form-control\",name:\"console\"},this.state.console.map(function(cons){return/*#__PURE__*/React.createElement(\"option\",null,cons);}));if(this.state.mode===\"customer\"){customers=/*#__PURE__*/React.createElement(\"select\",{className:\"form-control\",name:\"customer\",disabled:true},this.state.customers.map(function(customer){return/*#__PURE__*/React.createElement(\"option\",{value:customer._id},customer.name);}));games=/*#__PURE__*/React.createElement(\"select\",{className:\"form-control\",name:\"game\",onChange:this.handleGameChange,required:true},/*#__PURE__*/React.createElement(\"option\",{value:\"\",selected:true,disabled:true,hidden:true},\"Choose a Game\"),this.state.games.map(function(game){return/*#__PURE__*/React.createElement(\"option\",{value:game._id},game.name);}));}if(this.state.mode===\"game\"){customers=/*#__PURE__*/React.createElement(\"select\",{className:\"form-control\",name:\"customer\",required:true},/*#__PURE__*/React.createElement(\"option\",{value:\"\",selected:true,disabled:true,hidden:true},\"Choose a Customer\"),this.state.customers.map(function(customer){return/*#__PURE__*/React.createElement(\"option\",{value:customer._id},customer.name);}));games=/*#__PURE__*/React.createElement(\"select\",{className:\"form-control\",name:\"game\",disabled:true},this.state.games.map(function(game){return/*#__PURE__*/React.createElement(\"option\",{value:game._id},game.name);}));}if(this.state.mode===\"dashboard\"){customers=/*#__PURE__*/React.createElement(\"select\",{className:\"form-control\",name:\"customer\",required:true},/*#__PURE__*/React.createElement(\"option\",{value:\"\",selected:true,disabled:true,hidden:true},\"Choose a Customer\"),this.state.customers.map(function(customer){return/*#__PURE__*/React.createElement(\"option\",{value:customer._id},customer.name);}));games=/*#__PURE__*/React.createElement(\"select\",{className:\"form-control\",name:\"game\",onChange:this.handleGameChange,required:true},/*#__PURE__*/React.createElement(\"option\",{value:\"\",selected:true,disabled:true,hidden:true},\"Choose a Game\"),this.state.games.map(function(game){return/*#__PURE__*/React.createElement(\"option\",{value:game._id},game.name);}));}return/*#__PURE__*/React.createElement(\"div\",null,this.renderRedirect(),/*#__PURE__*/React.createElement(\"form\",{onSubmit:this.confirmIssue},/*#__PURE__*/React.createElement(\"label\",null,\"Customer Name\"),customers,/*#__PURE__*/React.createElement(\"label\",null,\"Game\"),games,/*#__PURE__*/React.createElement(\"label\",null,\"Console\"),_console,/*#__PURE__*/React.createElement(\"input\",{type:\"submit\",value:\"Issue OTP\",className:\"btn btn-primary\"})),/*#__PURE__*/React.createElement(Modal,{show:this.state.modal_show},/*#__PURE__*/React.createElement(Modal.Header,null,/*#__PURE__*/React.createElement(Modal.Title,null,\"Game Issue\")),/*#__PURE__*/React.createElement(\"form\",{onSubmit:this.handleForm},/*#__PURE__*/React.createElement(Modal.Body,null,this.state.button_disable?/*#__PURE__*/React.createElement(\"p\",null,\"Fill in Details\"):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",null,\"Enter OTP\"),/*#__PURE__*/React.createElement(\"input\",{type:\"number\",name:\"otp\"}),this.state.otp_issued?/*#__PURE__*/React.createElement(Toast,null,/*#__PURE__*/React.createElement(Toast.Header,null,/*#__PURE__*/React.createElement(\"strong\",{className:\"mr-auto\"},\"OTP\")),/*#__PURE__*/React.createElement(Toast.Body,null,this.state.message)):/*#__PURE__*/React.createElement(LoadingSpinner,null))),/*#__PURE__*/React.createElement(Modal.Footer,null,/*#__PURE__*/React.createElement(Button,{variant:\"secondary\",onClick:this.modalClose},\"Close\"),/*#__PURE__*/React.createElement(Button,{variant:\"primary\",type:\"submit\",disabled:this.state.button_disable},this.state.verifying?/*#__PURE__*/React.createElement(LoadingSpinner,null):\"Verify\")))));}else return/*#__PURE__*/React.createElement(\"div\",null,\"Can't Issue game\");}}]);return Issue;}(Component);export default Issue;","map":{"version":3,"sources":["C:/Prayuj Folders/Game-Renting-Service/frontend/src/components/issue.js"],"names":["React","Component","axios","Redirect","Modal","Button","Toast","LoadingSpinner","Issue","props","setRedirect","setState","redirect_to_transaction","renderRedirect","state","transactionid","match","params","mode","customer_id","id","show","games","console","modal_show","button_disable","otp_issued","verifying","game_id","customers","handleForm","bind","handleGameChange","confirmIssue","modalClose","getCustomerDetail","getGames","log","get","then","res","data","length","plan","noOfGames","catch","err","customers_to_display","i","latestMembership","active","push","numberAvailable","numberPS4Available","numberXBOXAvailable","e","preventDefault","target","game","value","customer","selected_console","message","otp","game_console","JSON","stringify","post","isVerify","alert","_id","map","cons","name"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport axios from \"axios\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport Modal from \"react-bootstrap/Modal\";\r\nimport Button from \"react-bootstrap/Button\";\r\nimport Toast from \"react-bootstrap/Toast\";\r\nimport LoadingSpinner from \"./loadingSpinner\";\r\n\r\nclass Issue extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    if (props.match.params.mode === \"customer\")\r\n      this.state = {\r\n        mode: \"customer\",\r\n        customer_id: props.match.params.id,\r\n        show: false,\r\n        games: [],\r\n        console: [],\r\n        redirect_to_transaction: false,\r\n        modal_show: false,\r\n        button_disable: true,\r\n        otp_issued: false,\r\n        verifying: false,\r\n      };\r\n    else if (props.match.params.mode === \"game\")\r\n      this.state = {\r\n        mode: \"game\",\r\n        game_id: props.match.params.id,\r\n        show: false,\r\n        customers: [],\r\n        console: [],\r\n        redirect_to_transaction: false,\r\n        modal_show: false,\r\n        button_disable: true,\r\n        otp_issued: false,\r\n        verifying: false,\r\n      };\r\n    else if (props.match.params.mode === \"dashboard\")\r\n      this.state = {\r\n        mode: \"dashboard\",\r\n        customers: [],\r\n        show: true,\r\n        games: [],\r\n        console: [],\r\n        redirect_to_transaction: false,\r\n        modal_show: false,\r\n        button_disable: true,\r\n        otp_issued: false,\r\n        verifying: false,\r\n      };\r\n    this.handleForm = this.handleForm.bind(this);\r\n    this.handleGameChange = this.handleGameChange.bind(this);\r\n    this.confirmIssue = this.confirmIssue.bind(this);\r\n    this.modalClose = this.modalClose.bind(this);\r\n  }\r\n  componentDidMount() {\r\n    this.getCustomerDetail();\r\n    this.getGames();\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    console.log(this.state.mode, this.props.match.params.mode);\r\n    if (this.state.mode !== this.props.match.params.mode) {\r\n      if (this.props.match.params.mode === \"customer\")\r\n        this.setState(\r\n          {\r\n            mode: \"customer\",\r\n            customer_id: this.props.match.params.id,\r\n          },\r\n          () => {\r\n            this.getCustomerDetail();\r\n            this.getGames();\r\n          }\r\n        );\r\n      else if (this.props.match.params.mode === \"game\")\r\n        this.setState(\r\n          {\r\n            mode: \"game\",\r\n            game_id: this.props.match.params.id,\r\n          },\r\n          () => {\r\n            this.getCustomerDetail();\r\n            this.getGames();\r\n          }\r\n        );\r\n      else if (this.props.match.params.mode === \"dashboard\")\r\n        this.setState(\r\n          {\r\n            mode: \"dashboard\",\r\n            show: true,\r\n          },\r\n          () => {\r\n            this.getCustomerDetail();\r\n            this.getGames();\r\n          }\r\n        );\r\n    }\r\n  }\r\n\r\n  getCustomerDetail() {\r\n    if (this.state.mode === \"customer\") {\r\n      axios\r\n        .get(\r\n          \"https://prayuj-gamerent.herokuapp.com/customer/issue/\" +\r\n            this.state.customer_id\r\n        )\r\n        .then((res) => {\r\n          console.log(res.data);\r\n          this.setState({\r\n            customers: [res.data],\r\n          });\r\n          if (res.data.length == 0) {\r\n            console.log(\"No Active Membership\");\r\n            this.setState({\r\n              show: false,\r\n            });\r\n          } else if (res.data.plan === \"1Y4G\" && res.data.noOfGames < 4) {\r\n            console.log(\"4 game plan\");\r\n            this.setState({\r\n              show: true,\r\n            });\r\n          } else if (res.data.plan === \"6M2G\" && res.data.noOfGames < 2) {\r\n            console.log(\"2 game plan\");\r\n            this.setState({\r\n              show: true,\r\n            });\r\n          } else if (res.data.plan === \"3M1G\" && res.data.noOfGames < 1) {\r\n            console.log(\"1 game plan\");\r\n            this.setState({\r\n              show: true,\r\n            });\r\n          } else {\r\n            console.log(\"5th condition\");\r\n            this.setState({\r\n              show: false,\r\n            });\r\n          }\r\n          this.setState({\r\n            data: res.data[0],\r\n          });\r\n        })\r\n        .catch((err) => console.log(err));\r\n    } else {\r\n      axios\r\n        .get(\"https://prayuj-gamerent.herokuapp.com/customer\")\r\n        .then((res) => {\r\n          let customers_to_display = [];\r\n          for (let i = 0; i < res.data.length; i++) {\r\n            if (res.data[i].latestMembership.active) {\r\n              if (\r\n                res.data[i].latestMembership.plan === \"1Y4G\" &&\r\n                res.data[i].noOfGames < 4\r\n              ) {\r\n                console.log(\"4 game plan\");\r\n                customers_to_display.push(res.data[i]);\r\n              } else if (\r\n                res.data[i].latestMembership.plan === \"6M2G\" &&\r\n                res.data[i].noOfGames < 2\r\n              ) {\r\n                console.log(\"2 game plan\");\r\n                customers_to_display.push(res.data[i]);\r\n              } else if (\r\n                res.data[i].latestMembership.plan === \"3M1G\" &&\r\n                res.data[i].noOfGames < 1\r\n              ) {\r\n                console.log(\"1 game plan\");\r\n                customers_to_display.push(res.data[i]);\r\n              } else {\r\n                console.log(\"5th condition\");\r\n              }\r\n            }\r\n          }\r\n          this.setState({\r\n            customers: customers_to_display,\r\n          });\r\n        })\r\n        .catch((err) => console.log(err));\r\n    }\r\n  }\r\n  getGames() {\r\n    if (this.state.mode === \"game\")\r\n      axios\r\n        .get(\"https://prayuj-gamerent.herokuapp.com/game/\" + this.state.game_id)\r\n        .then((res) => {\r\n          console.log(res.data);\r\n          this.setState({\r\n            games: [res.data],\r\n          });\r\n          if (res.data.numberAvailable > 0) {\r\n            this.setState({\r\n              show: true,\r\n            });\r\n          }\r\n          if (\r\n            res.data.numberPS4Available > 0 &&\r\n            res.data.numberXBOXAvailable > 0\r\n          ) {\r\n            this.setState({\r\n              console: [\"PS4\", \"XBOX One\"],\r\n            });\r\n          } else if (res.data.numberPS4Available > 0) {\r\n            this.setState({\r\n              console: [\"PS4\"],\r\n            });\r\n          } else if (res.data.numberXBOXAvailable > 0) {\r\n            this.setState({\r\n              console: [\"XBOX One\"],\r\n            });\r\n          } else {\r\n            this.setState({\r\n              console: [],\r\n            });\r\n          }\r\n        });\r\n    else\r\n      axios.get(\"https://prayuj-gamerent.herokuapp.com/game\").then((res) => {\r\n        console.log(res.data);\r\n        this.setState({\r\n          games: res.data,\r\n        });\r\n      });\r\n  }\r\n\r\n  modalClose() {\r\n    {\r\n      this.setState({ modal_show: false });\r\n    }\r\n  }\r\n\r\n  confirmIssue(e) {\r\n    e.preventDefault();\r\n    console.log(\r\n      e.target.game.value,\r\n      e.target.console.value,\r\n      e.target.customer.value\r\n    );\r\n    this.setState({\r\n      otp_issued: false,\r\n      verifying: false,\r\n    });\r\n    if (\r\n      e.target.game.value != \"default\" &&\r\n      e.target.console.value != \"default\" &&\r\n      e.target.customer.value != \"default\"\r\n    ) {\r\n      this.setState({\r\n        modal_show: true,\r\n        game_id: e.target.game.value,\r\n        selected_console: e.target.console.value,\r\n        customer_id: e.target.customer.value,\r\n        button_disable: false,\r\n      });\r\n      console.log(\r\n        \"https://prayuj-gamerent.herokuapp.com/customer/generate_otp/id=\" +\r\n          e.target.customer.value +\r\n          \"&mode=Issuing\" +\r\n          \"&game=\" +\r\n          e.target.game.value +\r\n          \"&console=\" +\r\n          e.target.console.value\r\n      );\r\n      axios\r\n        .get(\r\n          \"https://prayuj-gamerent.herokuapp.com/customer/generate_otp/id=\" +\r\n            e.target.customer.value +\r\n            \"&mode=Issuing\" +\r\n            \"&game=\" +\r\n            e.target.game.value +\r\n            \"&console=\" +\r\n            e.target.console.value\r\n        )\r\n        .then((res) => {\r\n          console.log(res.data);\r\n          this.setState({ message: res.data.message, otp_issued: true });\r\n        });\r\n    } else this.setState({ modal_show: true });\r\n  }\r\n  handleForm(e) {\r\n    e.preventDefault();\r\n    console.log(e.target.otp.value);\r\n    let customer_id = this.state.customer_id;\r\n    let game_id = this.state.game_id;\r\n    let game_console = this.state.selected_console;\r\n    let data = {\r\n      game_id: game_id,\r\n      console: game_console,\r\n    };\r\n    this.setState({\r\n      verifying: true,\r\n    });\r\n    console.log(JSON.stringify(data));\r\n    axios\r\n      .post(\r\n        \"https://prayuj-gamerent.herokuapp.com/customer/verify_otp/\" +\r\n          customer_id,\r\n        {\r\n          otp: e.target.otp.value,\r\n        }\r\n      )\r\n      .then((res) => {\r\n        console.log(res.data.isVerify);\r\n        if (res.data.isVerify) {\r\n          axios\r\n            .post(\r\n              \"https://prayuj-gamerent.herokuapp.com/customer/issue/\" +\r\n                customer_id,\r\n              data\r\n            )\r\n            .then((res) => {\r\n              if (res.data.game != \"Not Available\") {\r\n                this.setState({\r\n                  show: true,\r\n                });\r\n                this.setState({\r\n                  transactionid: res.data.game,\r\n                });\r\n                this.setRedirect();\r\n              } else {\r\n                alert(res.data.game);\r\n              }\r\n            })\r\n            .catch((err) => {\r\n              alert(JSON.stringify(err));\r\n            });\r\n        } else {\r\n          alert(\"Incorrect OTP, Issue again\");\r\n        }\r\n      });\r\n  }\r\n\r\n  handleGameChange(e) {\r\n    console.log(e.target.value);\r\n    let games = this.state.games;\r\n    for (let i = 0; i < games.length; i++) {\r\n      if (games[i]._id === e.target.value) {\r\n        if (\r\n          games[i].numberPS4Available > 0 &&\r\n          games[i].numberXBOXAvailable > 0\r\n        ) {\r\n          this.setState({\r\n            console: [\"PS4\", \"XBOX One\"],\r\n          });\r\n        } else if (games[i].numberPS4Available > 0) {\r\n          this.setState({\r\n            console: [\"PS4\"],\r\n          });\r\n        } else if (games[i].numberXBOXAvailable > 0) {\r\n          this.setState({\r\n            console: [\"XBOX One\"],\r\n          });\r\n        } else {\r\n          this.setState({\r\n            console: [],\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  setRedirect = () => {\r\n    this.setState({\r\n      redirect_to_transaction: true,\r\n    });\r\n  };\r\n\r\n  renderRedirect = () => {\r\n    if (this.state.redirect_to_transaction) {\r\n      return <Redirect push to={\"/transaction/\" + this.state.transactionid} />;\r\n    }\r\n  };\r\n  render() {\r\n    if (this.state.show) {\r\n      let customers;\r\n      let games;\r\n      let console =\r\n        this.state.console.length == 0 ? (\r\n          <select className=\"form-control\" name=\"console\" disabled={true}>\r\n            <option value=\"default\">Not Available</option>\r\n          </select>\r\n        ) : (\r\n          <select className=\"form-control\" name=\"console\">\r\n            {this.state.console.map((cons) => (\r\n              <option>{cons}</option>\r\n            ))}\r\n          </select>\r\n        );\r\n      if (this.state.mode === \"customer\") {\r\n        customers = (\r\n          <select className=\"form-control\" name=\"customer\" disabled={true}>\r\n            {this.state.customers.map((customer) => (\r\n              <option value={customer._id}>{customer.name}</option>\r\n            ))}\r\n          </select>\r\n        );\r\n        games = (\r\n          <select\r\n            className=\"form-control\"\r\n            name=\"game\"\r\n            onChange={this.handleGameChange}\r\n            required\r\n          >\r\n            <option value=\"\" selected disabled hidden>\r\n              Choose a Game\r\n            </option>\r\n            {this.state.games.map((game) => (\r\n              <option value={game._id}>{game.name}</option>\r\n            ))}\r\n          </select>\r\n        );\r\n      }\r\n\r\n      if (this.state.mode === \"game\") {\r\n        customers = (\r\n          <select className=\"form-control\" name=\"customer\" required>\r\n            <option value=\"\" selected disabled hidden>\r\n              Choose a Customer\r\n            </option>\r\n            {this.state.customers.map((customer) => (\r\n              <option value={customer._id}>{customer.name}</option>\r\n            ))}\r\n          </select>\r\n        );\r\n\r\n        games = (\r\n          <select className=\"form-control\" name=\"game\" disabled={true}>\r\n            {this.state.games.map((game) => (\r\n              <option value={game._id}>{game.name}</option>\r\n            ))}\r\n          </select>\r\n        );\r\n      }\r\n\r\n      if (this.state.mode === \"dashboard\") {\r\n        customers = (\r\n          <select className=\"form-control\" name=\"customer\" required>\r\n            <option value=\"\" selected disabled hidden>\r\n              Choose a Customer\r\n            </option>\r\n            {this.state.customers.map((customer) => (\r\n              <option value={customer._id}>{customer.name}</option>\r\n            ))}\r\n          </select>\r\n        );\r\n\r\n        games = (\r\n          <select\r\n            className=\"form-control\"\r\n            name=\"game\"\r\n            onChange={this.handleGameChange}\r\n            required\r\n          >\r\n            <option value=\"\" selected disabled hidden>\r\n              Choose a Game\r\n            </option>\r\n            {this.state.games.map((game) => (\r\n              <option value={game._id}>{game.name}</option>\r\n            ))}\r\n          </select>\r\n        );\r\n      }\r\n\r\n      return (\r\n        <div>\r\n          {this.renderRedirect()}\r\n          <form onSubmit={this.confirmIssue}>\r\n            <label>Customer Name</label>\r\n            {customers}\r\n            <label>Game</label>\r\n            {games}\r\n            <label>Console</label>\r\n            {console}\r\n            <input\r\n              type=\"submit\"\r\n              value=\"Issue OTP\"\r\n              className=\"btn btn-primary\"\r\n            />\r\n          </form>\r\n          <Modal show={this.state.modal_show}>\r\n            <Modal.Header>\r\n              <Modal.Title>Game Issue</Modal.Title>\r\n            </Modal.Header>\r\n            <form onSubmit={this.handleForm}>\r\n              <Modal.Body>\r\n                {this.state.button_disable ? (\r\n                  <p>Fill in Details</p>\r\n                ) : (\r\n                  <>\r\n                    <div>Enter OTP</div>\r\n                    <input type=\"number\" name=\"otp\" />\r\n                    {this.state.otp_issued ? (\r\n                      <Toast>\r\n                        <Toast.Header>\r\n                          <strong className=\"mr-auto\">OTP</strong>\r\n                        </Toast.Header>\r\n                        <Toast.Body>{this.state.message}</Toast.Body>\r\n                      </Toast>\r\n                    ) : (\r\n                      <LoadingSpinner></LoadingSpinner>\r\n                    )}\r\n                  </>\r\n                )}\r\n              </Modal.Body>\r\n\r\n              <Modal.Footer>\r\n                <Button variant=\"secondary\" onClick={this.modalClose}>\r\n                  Close\r\n                </Button>\r\n                <Button\r\n                  variant=\"primary\"\r\n                  type=\"submit\"\r\n                  disabled={this.state.button_disable}\r\n                >\r\n                  {this.state.verifying ? (\r\n                    <LoadingSpinner></LoadingSpinner>\r\n                  ) : (\r\n                    \"Verify\"\r\n                  )}\r\n                </Button>\r\n              </Modal.Footer>\r\n            </form>\r\n          </Modal>\r\n        </div>\r\n      );\r\n    } else return <div>Can't Issue game</div>;\r\n  }\r\n}\r\n\r\nexport default Issue;\r\n"]},"metadata":{},"sourceType":"module"}